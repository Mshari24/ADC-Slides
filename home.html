<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Home</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body class="home-body">
  <div class="home-root">
    <aside class="home-sidebar" aria-label="Main">
      <a class="sb-item" href="/profile/" title="Profile">
        <div class="sb-icon avatar">R</div>
        <div class="sb-label">Profile</div>
      </a>
      <a class="sb-item active" href="./home.html" title="Home">
        <div class="sb-icon">ğŸ </div>
        <div class="sb-label">Home</div>
      </a>
      <a class="sb-item" href="./notifications.html" title="Notifications">
        <div class="sb-icon">ğŸ””</div>
        <div class="sb-label">Notifications</div>
      </a>
      <a class="sb-item" href="./groups.html" title="Groups">
        <div class="sb-icon">ğŸ‘¥</div>
        <div class="sb-label">Groups</div>
      </a>
      <a class="sb-item" href="./projects.html" title="Projects">
        <div class="sb-icon">ğŸ“</div>
        <div class="sb-label">Projects</div>
      </a>
      <a class="sb-item" href="./teams.html" title="Microsoft Teams">
        <div class="sb-icon">ğŸ’¬</div>
        <div class="sb-label">Teams</div>
      </a>
      <a class="sb-item" href="https://outlook.office.com/mail/" target="_blank" rel="noopener noreferrer" title="Outlook">
        <div class="sb-icon">ğŸ“§</div>
        <div class="sb-label">Outlook</div>
      </a>
    </aside>

    <main class="home-main">
      <header class="home-top">
        <div class="top-spacer"></div>
        <h1 id="greeting" class="greeting">Good Morning!</h1>
        <div class="top-logo">
          <img src="./pic/aramco-digital.png" alt="Aramco Digital" />
        </div>
      </header>

      <section class="home-search">
        <div class="search-wrap" role="search">
          <input id="home-search" class="search-input" type="search" placeholder="Search Recent and Projectsâ€¦" aria-label="Search Recent and Projects" />
        </div>
      </section>

      <section class="home-middle">
        <div class="panel create">
          <div class="panel-head">
            <h2>Create</h2>
          </div>
          <div class="panel-grid four create-grid">
            <button id="btn-blank" class="tile tile-blank" type="button" title="Blank Presentation">
              <div class="tile-icon">+</div>
              <div class="tile-label">Blank Presentation</div>
            </button>
            <button id="btn-ad" class="tile" type="button" title="AD Template">
              <div class="tile-icon">ğŸ…°ï¸</div>
              <div class="tile-label">AD</div>
            </button>
            <button id="btn-import" class="tile" type="button" title="Import Slides">
              <div class="tile-icon">â¬†ï¸</div>
              <div class="tile-label">Import Slides</div>
            </button>
            <button id="btn-theme" class="tile" type="button" title="Import Theme">
              <div class="tile-icon">ğŸ¨</div>
              <div class="tile-label">Import Theme</div>
            </button>
            <input id="input-import-slides" type="file" accept=".json,.ppt,.pptx,.odp" style="display:none" />
            <input id="input-import-theme" type="file" accept=".json,.zip,.thm" style="display:none" />
          </div>
        </div>

        <div class="panel recent">
          <div class="panel-head">
            <h2>Recent</h2>
            <a href="#" class="show-all">Show all</a>
          </div>
          <div class="panel-grid four" id="recent-list">
            <a class="file-card" href="./index.html?open=q3-report" data-title="Q3 Report">
              <div class="file-icon">ğŸ“„</div>
              <div class="file-meta">
                <div class="file-name">Q3 Report</div>
                <div class="file-sub">Last opened: Sep 18, 2025</div>
              </div>
            </a>
            <a class="file-card" href="./index.html?open=all-hands" data-title="Team All-Hands">
              <div class="file-icon">ğŸ“Š</div>
              <div class="file-meta">
                <div class="file-name">Team All-Hands</div>
                <div class="file-sub">Last opened: Oct 2, 2025</div>
              </div>
            </a>
            <a class="file-card" href="./index.html?open=roadmap" data-title="Product Roadmap">
              <div class="file-icon">ğŸ—‚ï¸</div>
              <div class="file-meta">
                <div class="file-name">Product Roadmap</div>
                <div class="file-sub">Last opened: Oct 31, 2025</div>
              </div>
            </a>
            <a class="file-card" href="./index.html?open=proposal" data-title="Client Proposal">
              <div class="file-icon">ğŸ“</div>
              <div class="file-meta">
                <div class="file-name">Client Proposal</div>
                <div class="file-sub">Last opened: Nov 1, 2025</div>
              </div>
            </a>
          </div>
        </div>

        <div class="panel projects">
          <div class="panel-head">
            <h2>Projects</h2>
            <a href="#" class="show-all">Show all</a>
          </div>
          <div class="panel-grid four" id="projects-list">
            <div class="card" data-title="Neptune Migration">Neptune Migration</div>
            <div class="card" data-title="SaaS Analytics">SaaS Analytics</div>
            <div class="card" data-title="Slides Editor">Slides Editor</div>
            <div class="card" data-title="AI Assistant">AI Assistant</div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    // Derive name from query string and set greeting; also set avatar initial
    (function () {
      const params = new URLSearchParams(location.search);
      const nameParam = params.get('name') || '';
      const now = new Date();
      const hour = now.getHours();
      const part = hour < 12 ? 'Morning' : hour < 18 ? 'Afternoon' : 'Evening';
      const name = nameParam.trim();
      const greeting = document.getElementById('greeting');
      greeting.textContent = `Good ${part}${name ? ', ' + name + '!' : '!'}`;

      const avatar = document.querySelector('.sb-icon.avatar');
      if (avatar) {
        const initial = name ? name[0].toUpperCase() : 'U';
        avatar.textContent = initial;
      }
      // Search across Recent and Projects
      const input = document.getElementById('home-search');
      const lists = [document.getElementById('recent-list'), document.getElementById('projects-list')];
      function applyFilter(q) {
        const query = (q || '').trim().toLowerCase();
        lists.forEach(list => {
          if (!list) return;
          const items = list.classList.contains('panel-grid') ? list.children : list.querySelectorAll('.card');
          Array.from(items).forEach(card => {
            const title = (card.getAttribute('data-title') || card.textContent || '').toLowerCase();
            card.style.display = query && !title.includes(query) ? 'none' : '';
          });
        });
      }
      input && input.addEventListener('input', (e) => applyFilter(e.target.value));

      // Create tiles actions
      const btnBlank = document.getElementById('btn-blank');
      const btnAd = document.getElementById('btn-ad');
      const btnImport = document.getElementById('btn-import');
      const btnTheme = document.getElementById('btn-theme');
      const inputSlides = document.getElementById('input-import-slides');
      const inputTheme = document.getElementById('input-import-theme');

      btnBlank && btnBlank.addEventListener('click', () => {
        window.location.href = './index.html';
      });
      btnAd && btnAd.addEventListener('click', () => {
        window.location.href = './index.html?template=ad';
      });
      btnImport && btnImport.addEventListener('click', () => inputSlides && inputSlides.click());
      btnTheme && btnTheme.addEventListener('click', () => inputTheme && inputTheme.click());

      function showToast(msg) {
        const el = document.createElement('div');
        el.textContent = msg; el.style.position='fixed'; el.style.bottom='16px'; el.style.left='50%'; el.style.transform='translateX(-50%)';
        el.style.background='#111827'; el.style.color='#fff'; el.style.padding='10px 14px'; el.style.borderRadius='10px'; el.style.zIndex='9999';
        document.body.appendChild(el); setTimeout(()=>{ el.remove(); }, 1800);
      }
      inputSlides && inputSlides.addEventListener('change', (e) => {
        const f = e.target.files && e.target.files[0];
        if (f) showToast('Imported: ' + f.name + ' (demo)');
        e.target.value = '';
      });
      inputTheme && inputTheme.addEventListener('change', (e) => {
        const f = e.target.files && e.target.files[0];
        if (f) showToast('Theme imported: ' + f.name + ' (demo)');
        e.target.value = '';
      });
    })();
  </script>
</body>
</html>


